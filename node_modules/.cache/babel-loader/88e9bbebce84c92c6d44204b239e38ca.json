{"ast":null,"code":"import _regeneratorRuntime from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _asyncToGenerator from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/andre/bootcamp2020/my-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{FaGithubAlt,FaPlus,FaSpinner}from'react-icons/fa';import{Link}from'react-router-dom';import api from'../../services/api';import Container from'../../components/Container';import{Form,SubmitButton,List}from'./styles';var Main=/*#__PURE__*/function(_Component){_inherits(Main,_Component);function Main(){var _getPrototypeOf2;var _this;_classCallCheck(this,Main);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Main)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={newRepo:'',repositories:[],loading:false,error:null};_this.handleInputChange=function(e){_this.setState({newRepo:e.target.value});};_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var _this$state,newRepo,repositories,hasRepo,response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();_this.setState({loading:true,error:false});_context.prev=2;_this$state=_this.state,newRepo=_this$state.newRepo,repositories=_this$state.repositories;if(!(newRepo==='')){_context.next=6;break;}throw'Você precisa indicar um repositório';case 6:hasRepo=repositories.find(function(r){return r.name===newRepo;});if(!hasRepo){_context.next=9;break;}throw'Repositório Duplicado';case 9:_context.next=11;return api.get(\"/repos/\".concat(newRepo));case 11:response=_context.sent;data={name:response.data.full_name};_this.setState({repositories:[].concat(_toConsumableArray(repositories),[data]),newRepo:''});_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](2);_this.setState({error:true});case 19:_context.prev=19;_this.setState({loading:false});return _context.finish(19);case 22:case\"end\":return _context.stop();}}},_callee,null,[[2,16,19,22]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(Main,[{key:\"componentDidMount\",// Carregar os dados do localStorage\nvalue:function componentDidMount(){var repositories=localStorage.getItem('repositories');if(repositories){this.setState({repositories:JSON.parse(repositories)});}}// Salvar os dados do localStorage\n},{key:\"componentDidUpdate\",value:function componentDidUpdate(_,prevState){var repositories=this.state.repositories;if(prevState.repositories!==repositories){localStorage.setItem('repositories',JSON.stringify(repositories));}}},{key:\"render\",value:function render(){var _this$state2=this.state,newRepo=_this$state2.newRepo,loading=_this$state2.loading,repositories=_this$state2.repositories,error=_this$state2.error;return React.createElement(Container,null,React.createElement(\"h1\",null,React.createElement(FaGithubAlt,null),\"Reposit\\xF3rios\"),React.createElement(Form,{onSubmit:this.handleSubmit,error:error},React.createElement(\"input\",{type:\"text\",placeholder:\"Adicionar reposit\\xF3rio\",value:newRepo,onChange:this.handleInputChange}),React.createElement(SubmitButton,{loading:loading},loading?React.createElement(FaSpinner,{color:\"#FFF\",size:14}):React.createElement(FaPlus,{color:\"#FFF\",size:14}))),React.createElement(List,null,repositories.map(function(repository){return React.createElement(\"li\",{key:repository.name},React.createElement(\"span\",null,repository.name),React.createElement(Link,{to:\"/repository/\".concat(encodeURIComponent(repository.name))},\"Detalhes\"));})));}}]);return Main;}(Component);export{Main as default};","map":{"version":3,"sources":["/home/andre/bootcamp2020/my-app/src/pages/Main/index.js"],"names":["React","Component","FaGithubAlt","FaPlus","FaSpinner","Link","api","Container","Form","SubmitButton","List","Main","state","newRepo","repositories","loading","error","handleInputChange","e","setState","target","value","handleSubmit","preventDefault","hasRepo","find","r","name","get","response","data","full_name","localStorage","getItem","JSON","parse","_","prevState","setItem","stringify","map","repository","encodeURIComponent"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { FaGithubAlt, FaPlus, FaSpinner } from 'react-icons/fa';\nimport {\tLink\t} from 'react-router-dom';\n\nimport api from '../../services/api';\n\nimport Container from '../../components/Container';\n\nimport { Form, SubmitButton, List } from'./styles';\n\nexport default class Main extends Component {\n\tstate = {\n\t\tnewRepo: '',\n\t\trepositories: [],\n\t\tloading: false,\n\t\terror: null,\n\t};\n\n\t// Carregar os dados do localStorage\n\tcomponentDidMount() {\n\t\tconst repositories = localStorage.getItem('repositories');\n\n\t\tif (repositories) {\n\t\t\tthis.setState({\trepositories: JSON.parse(repositories) });\n\t\t}\n\t}\n\n\t// Salvar os dados do localStorage\n\tcomponentDidUpdate(_, prevState) {\n\t\tconst {\trepositories\t} = this.state;\n\n\t\tif (prevState.repositories !== repositories) {\n\t\t\tlocalStorage.setItem('repositories', JSON.stringify(repositories));\n\t\t}\n\t}\n\n\thandleInputChange = e => {\n\t\tthis.setState({\tnewRepo: e.target.value\t});\n\t};\n\n\thandleSubmit = async e => {\n\t\te.preventDefault();\n\n\t\tthis.setState({\tloading: true, error: false });\n\n\t\ttry {\n\t\t\tconst {\tnewRepo, repositories\t} = this.state;\n\n\t\t\tif (newRepo === '') throw 'Você precisa indicar um repositório';\n\n\t\t\tconst hasRepo = repositories.find(r => r.name === newRepo);\n\n\t\t\tif (hasRepo) throw 'Repositório Duplicado';\n\n\t\t\tconst response = await api.get(`/repos/${newRepo}`);\n\n\t\t\tconst data = {\n\t\t\t\tname: response.data.full_name,\n\t\t\t};\n\n\t\t\tthis.setState({\n\t\t\t\trepositories: [...repositories, data],\n\t\t\t\tnewRepo: '',\n\t\t\t});\n\t\t}\n\t\tcatch (error) {\n\t\t\tthis.setState({error: true});\n\t\t} finally {\n\t\t\tthis.setState({loading: false});\n\t\t}\n\t\t\n\t};\n\t\n\trender() {\n\t\tconst {\tnewRepo, loading, repositories, error } = this.state;\n\n\t\treturn (\n\t\t<Container>\n\t\t\t<h1>\n\t\t\t<FaGithubAlt />\n\t\t\tRepositórios\n\t\t\t</h1>\n\n\t\t\t<Form onSubmit={this.handleSubmit} error={error}>\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\tplaceholder=\"Adicionar repositório\"\n\t\t\t\t\t\t\tvalue = {newRepo}\n\t\t\t\t\t\t\tonChange={this.handleInputChange}\t\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<SubmitButton loading={loading}>\n\t\t\t\t\t\t\t{loading ? (\n\t\t\t\t\t\t\t\t\t<FaSpinner color=\"#FFF\" size={14} />\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<FaPlus color=\"#FFF\" size={14} />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</SubmitButton>\n\t\t\t</Form>\n\n\t\t\t\t\t<List>\n\t\t\t\t\t\t{repositories.map(repository => (\n\t\t\t\t\t\t\t<li key={repository.name}>\n\t\t\t\t\t\t\t\t<span>{repository.name}</span>\n\t\t\t\t\t\t\t\t<Link to={`/repository/${encodeURIComponent(repository.name)}`}>Detalhes</Link>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</List>\n\t\t</Container>\n\t\t\t);\n\t}\n}"]},"metadata":{},"sourceType":"module"}