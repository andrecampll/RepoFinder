{"ast":null,"code":"import _slicedToArray from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/andre/bootcamp2020/FirstReactProject/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{FaSpinner}from'react-icons/fa';import{Link}from'react-router-dom';import api from'../../services/api';import Container from'../../components/Container';import{Loading,Owner,IssueList,IssueFilter,PageActions}from'./styles';var Repository=/*#__PURE__*/function(_Component){_inherits(Repository,_Component);function Repository(){var _getPrototypeOf2;var _this;_classCallCheck(this,Repository);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(Repository)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={repository:{},issues:[],loading:true,filters:[{state:'all',label:'Todas',active:true},{state:'open',label:'Abertas',active:false},{state:'closed',label:'Fechadas',active:false}],filterIndex:0,page:1};_this.loadIssues=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var match,_this$state,filters,filterIndex,page,repoName,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:match=_this.props.match;_this$state=_this.state,filters=_this$state.filters,filterIndex=_this$state.filterIndex,page=_this$state.page;repoName=decodeURIComponent(match.params.repository);_context.next=5;return api.get(\"/repos/\".concat(repoName,\"/issues\"),{params:{state:filters[filterIndex].state,per_page:5,page:page}});case 5:response=_context.sent;_this.setState({issues:response.data});case 7:case\"end\":return _context.stop();}}},_callee);}));_this.handleFilterClick=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(filterIndex){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _this.setState({filterIndex:filterIndex});case 2:_this.loadIssues();case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.handlePage=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(action){var page;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:page=_this.state.page;_context3.next=3;return _this.setState({page:action==='back'?page-1:page+1});case 3:_this.loadIssues();case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2){return _ref3.apply(this,arguments);};}();return _this;}_createClass(Repository,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var match,filters,repoName,_ref4,_ref5,repository,issues;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:match=this.props.match;filters=this.state.filters;repoName=decodeURIComponent(match.params.repository);_context4.next=5;return Promise.all([api.get(\"/repos/\".concat(repoName)),api.get(\"/repos/\".concat(repoName,\"/issues\"),{params:{state:filters.find(function(f){return f.active;}).state,per_page:5}})]);case 5:_ref4=_context4.sent;_ref5=_slicedToArray(_ref4,2);repository=_ref5[0];issues=_ref5[1];this.setState({repository:repository.data,issues:issues.data,loading:false});case 10:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,repository=_this$state2.repository,issues=_this$state2.issues,loading=_this$state2.loading,filters=_this$state2.filters,filterIndex=_this$state2.filterIndex,page=_this$state2.page;if(loading){return React.createElement(Loading,{loading:loading},loading?React.createElement(FaSpinner,{color:\"#FFF\",size:14}):'',\"Carregando\");}return React.createElement(Container,null,React.createElement(Owner,null,React.createElement(Link,{to:\"/\"},\"Voltar aos reposit\\xF3rios\"),React.createElement(\"img\",{src:repository.owner.avatar_url,alt:repository.owner.login}),React.createElement(\"h1\",null,repository.name),React.createElement(\"p\",null,repository.description)),React.createElement(IssueList,null,React.createElement(IssueFilter,{active:filterIndex},filters.map(function(filter,index){return React.createElement(\"button\",{key:filter.label,onClick:function onClick(){return _this2.handleFilterClick(index);}},filter.label);})),issues.map(function(issue){return React.createElement(\"li\",{key:String(issue.id)},React.createElement(\"img\",{src:issue.user.avatar_url,alt:issue.user.login}),React.createElement(\"div\",null,React.createElement(\"strong\",null,React.createElement(\"a\",{href:issue.html_url,target:\"_blank\"},issue.title),issue.labels.map(function(label){return React.createElement(\"span\",{key:String(label.id)},label.name);})),React.createElement(\"p\",null,issue.user.login)));})),React.createElement(PageActions,null,React.createElement(\"button\",{type:\"button\",disabled:page<2,onClick:function onClick(){return _this2.handlePage('back');}},\"Anterior\"),React.createElement(\"span\",null,\"P\\xE1gina \",page),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return _this2.handlePage('next');}},\"Pr\\xF3ximo\")));}}]);return Repository;}(Component);export{Repository as default};","map":{"version":3,"sources":["/home/andre/bootcamp2020/FirstReactProject/src/pages/Repository/index.js"],"names":["React","Component","FaSpinner","Link","api","Container","Loading","Owner","IssueList","IssueFilter","PageActions","Repository","state","repository","issues","loading","filters","label","active","filterIndex","page","loadIssues","match","props","repoName","decodeURIComponent","params","get","per_page","response","setState","data","handleFilterClick","handlePage","action","Promise","all","find","f","owner","avatar_url","login","name","description","map","filter","index","issue","String","id","user","html_url","title","labels"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { FaSpinner } from 'react-icons/fa';\nimport { Link } from 'react-router-dom';\nimport PropTypes from 'prop-types';\nimport api from '../../services/api';\n\nimport Container from '../../components/Container';\nimport { Loading, Owner, IssueList, IssueFilter, PageActions } from './styles';\n\nexport default class Repository extends Component {\n  static propTypes = {\n    match: PropTypes.shape({\n      params: PropTypes.shape({\n        repository: PropTypes.string,\n      }),\n    }).isRequired,\n  };\n  \n\n  state = {\n    repository: {},\n    issues: [],\n    loading: true,\n    filters: [\n      { state: 'all', label: 'Todas', active: true },\n      { state: 'open', label: 'Abertas', active: false },\n      { state: 'closed', label: 'Fechadas', active: false },\n    ],\n    filterIndex: 0,\n    page: 1,\n  };\n\n  async componentDidMount() {\n    const { match } = this.props;\n    const { filters } = this.state;\n\n    const repoName = decodeURIComponent(match.params.repository);\n\n    const [repository, issues] = await Promise.all([\n      api.get(`/repos/${repoName}`),\n      api.get(`/repos/${repoName}/issues`, {\n        params: {\n          state: filters.find(f => f.active).state,\n          per_page: 5,\n        },\n      }), \n    ]);\n    \n    this.setState({\n      repository: repository.data,\n      issues: issues.data,\n      loading: false,\n    });\n  }\n\n  loadIssues = async () => {\n    const { match } = this.props;\n    const { filters, filterIndex, page } = this.state;\n\n    const repoName = decodeURIComponent(match.params.repository);\n\n    const response = await api.get(`/repos/${repoName}/issues`, {\n      params: {\n        state: filters[filterIndex].state,\n        per_page: 5,\n        page,\n      },\n    });\n\n    this.setState({ issues: response.data });\n  };\n\n  handleFilterClick = async filterIndex => {\n    await this.setState({ filterIndex });\n    this.loadIssues();\n  };\n\n  handlePage = async action => {\n    const { page } = this.state;\n    await this.setState({\n      page: action === 'back' ? page - 1 : page + 1,\n    });\n    this.loadIssues();\n  }\n\n  render() {\n    const { repository, issues, loading, filters, filterIndex, page } = this.state;\n\n    if(loading) {\n      return <Loading loading={loading}>\n        {loading ? (\n          <FaSpinner color=\"#FFF\" size={14} />\n        ) : ('')}Carregando</Loading>\n    }\n\n    return (\n      <Container>\n        <Owner>\n          <Link to=\"/\">Voltar aos repositórios</Link>\n          <img src={repository.owner.avatar_url} alt={repository.owner.login}/>\n          <h1>{repository.name}</h1>\n          <p>{repository.description}</p>\n        </Owner>\n\n        <IssueList>\n          <IssueFilter active={filterIndex}>\n            {filters.map((filter, index) => (\n              <button \n                key={filter.label}\n                onClick={() => this.handleFilterClick(index)}\n            >\n              {filter.label}\n              </button>\n            ))}\n          </IssueFilter>\n          {issues.map( issue => (\n            <li key={String(issue.id)}>\n              <img src={issue.user.avatar_url} alt={issue.user.login} />\n              <div>\n                <strong>\n                  <a href={issue.html_url} target=\"_blank\">{issue.title}</a>\n                  {issue.labels.map(label => (\n                    <span key={String(label.id)}>{label.name}</span>\n                  ))}\n                </strong>\n                <p>{issue.user.login}</p>\n              </div>\n            </li>\n          ))}\n        </IssueList>\n        <PageActions>\n          <button\n            type=\"button\"\n            disabled={page<2}\n            onClick={() => this.handlePage('back')}\n          >\n            Anterior\n          </button>\n          <span>Página {page}</span>\n          <button type=\"button\" onClick={() => this.handlePage('next')}>\n            Próximo\n          </button>\n        </PageActions>\n      </Container>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}